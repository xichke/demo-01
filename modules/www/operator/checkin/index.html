<div id="particles" class="login page-login checkin">
    <div class="color-overlay"></div>
    <div class="container-login">
        <div class="wrap-login">
            <section id="phoneInput" class="">
                <div class="wrap-input">
                    <input id="txtPhone" class="input" type="text" readonly="readonly">
                    <span class="focus-input" data-placeholder="&#xf2be;"></span>
                </div>
                <div id="spin" class="sk-wave toshow">
                    <div class="sk-wave-rect"></div>
                    <div class="sk-wave-rect"></div>
                    <div class="sk-wave-rect"></div>
                    <div class="sk-wave-rect"></div>
                    <div class="sk-wave-rect"></div>
                </div>
                <section id="nameInput" class="toshow">
                    <div class="wrap-input">
                        <input id="txtName" class="input" type="text" placeholder="Name">
                        <span class="focus-input" data-placeholder="&#xf207;"></span>
                    </div>
                    <div class="container-login-form-btn">
                        <button id="btnCheckin" type="button" class="login-form-btn">
                            Check In
                        </button>
                    </div>
                </section>
                <section id="welcome" class="center toshow">
                    <h4 class="white">Welcome <b id="name"></b> to</h4>
                    <h1 class="white" id="operator"></h1>
                    <h6 class="white">You checked in successfully</h6>
                    <br/><br/>
                    <h5 class="white">Please have a seat</h5>
                    <h5 class="white">Someone will be with you shortly</h5>
                    <br/><br/>

                    <h6 class="white">Your order number is</h6>
                    <h1 class="white" id="order"></h1>
                    <a class="checkin-refresh" href="/checkin">
                        <i class="zmdi zmdi-refresh zmdi-hc-5x white"></i>
                    </a>
                </section>
                <div id="keyboard" class="simple-keyboard"></div>
            </section>
        </div>
    </div>
</div>
<style type="text/css">
html body {
    overflow: hidden !important;
}

#phoneInput {
    position: relative;
}

#spin {
    position: absolute;
    top: 0px;
    right: 20px;
}

.round {
    border-radius: 50%;
}
</style>
<script type="text/javascript">
$(function() {
    let Keyboard = window.SimpleKeyboard.default;
    let keyboard = new Keyboard({
        maxLength: 10,
        onChange: function(number) {
            var mask = ['(', /[1-9]/, /\d/, /\d/, ')', ' ', /\d/, /\d/, /\d/, ' ', /\d/, /\d/, /\d/, /\d/];
            number = vanillaTextMask.conformToMask(number, mask).conformedValue;
            $('#txtPhone').val(number);
            if (number && number.indexOf('_') < 0) {
                checkin();
            }
        },
        onKeyPress: function(e) {
            if (e === '{enter}') {
                checkin();
            }
        },
        layout: {
            default: ["1 2 3", "4 5 6", "7 8 9", "{bksp} 0 "]
        },
        theme: "hg-theme-default hg-layout-numeric numeric-theme"
    });

    var show = function(e) {
            $(e).removeClass('toshow').addClass('animated fadeIn fast');
        },
        hide = function(e) {
            $(e).addClass('animated fadeOut fast').addClass('toshow');
        };
    $('#btnCheckin').click(checkin);

    function checkin() {
        show('#spin');
        hide('#keyboard');
        var phone = $('#txtPhone').val(),
            name = $('#txtName').val();
        $.ajax({
            type: 'POST',
            url: '/checkin',
            data: JSON.stringify({
                phone: phone,
                name: name
            }),
            contentType: "application/json",
            dataType: 'json'
        }).done(function(e) {
            if (e.requireName) {
                hide('#spin');
                show('#nameInput');
            } else if (e.success) {
                hide('#nameInput');
                $('#operator').html(e.operator);
                $('#order').html('#' + e.order);
                $('#name').html(name || e.name);
                show('#welcome');
                hide('#spin');
            }

        });
    }
});
</script>